{
  "lex": {
    "rules": [
      ["\\s+", "/* skip whitespace */"],
      ["[0-9]+(\\.[0-9]+)?", "return 'NUMBER';"],
      ["\\+", "return 'ADD';"],
      ["-", "return 'SUBTRACT';"],
      ["\\*", "return 'MULTIPLY';"],
      ["\\/", "return  'DIVIDE';"],
      ["\\^", "return 'POWER';"],
      ["=", "return 'EQUALS';"],
      ["<", "return 'LT';"],
      ["<=", "return 'LTEQ';"],
      ["≤", "return 'LTEQ';"],
      [">", "return 'GT';"],
      [">=", "return 'GTEQ';"],
      ["≥", "return 'GTEQ';"],
      ["\\(", "return 'OPEN';"],
      ["\\)", "return 'CLOSE';"],
      ["$", "return 'EOF';"],
      ["[a-z]", "return 'VARIABLE';"]
    ]
  },

  "bnf": {
    "input": [
      ["statement EOF", "return $1;"],
      ["expression EOF", "return $1;"]
    ],

    "statement": [
      ["expression EQUALS expression", "$$ = yy.createNode('statement', ['equals', $1, $3]);"],
      ["expression LT expression", "$$ = yy.createNode('statement', ['lt', $1, $3]);"],
      ["expression GT expression", "$$ = yy.createNode('statement', ['gt', $1, $3]);"],
      ["expression LTEQ expression", "$$ = yy.createNode('statement', ['lteq', $1, $3]);"],
      ["expression GTEQ expression", "$$ = yy.createNode('statement', ['gteq', $1, $3]);"]
    ],

    "expression": [
      ["expression ADD term", "$$ = yy.append($1, {value: $3, negate: false});"],
      ["expression SUBTRACT term", "$$ = yy.append($1, {value: $3, negate: true});"],
      ["term", "$$ = yy.createNode('termlist', [{value: $1, negate: false}]);"]
    ],

    "term": [
      ["term MULTIPLY factor", "$$ = yy.append($1, {value: $3, invert: false});"],
      ["term factor", "$$ = yy.append($1, {value: $3, invert: false});"],
      ["term DIVIDE factor", "$$ = yy.append($1, {value: $3, invert: true});"],
      ["factor", "$$ = yy.createNode('factorlist', [{value: $1, invert: false}]);"]
    ],

    "factor": [
      ["OPEN expression CLOSE", "$$ = $2;"],
      ["factor POWER atom", "$$ = yy.createNode('fun', ['power', $1, $3]);"],
      ["atom", "$$ = $1;"]
    ],

    "atom": [
      ["NUMBER", "$$ = yy.createNode('atom', ['number', $1]);"],
      ["VARIABLE", "$$ = yy.createNode('atom', ['variable', $1]);"]
    ]
  }
}
